<h1>Sign Up for Free</h1>
<form action="#" [formGroup]="formModel" (ngSubmit)="submit(formModel.value)">
  <fieldset class="top-row">
    <div class="field-wrap">
      <label for="firstName" class="required">First Name</label>
      <input type="text" name="firstName" id="firstName" formControlName="firstName"
              [ngClass]="{onError: firstName.invalid && (firstName.dirty || firstName.touched)}">
      <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)">
        <div class="formErrorMessage" *ngIf="firstName.errors.required">
            First Name is required.
        </div>
        <div class="formHelpMessage" *ngIf="firstName.errors.minlength">
          Please add {{fieldWidth - firstName.value.length}} more character(s)
        </div>
      </div>
    </div>

    <div class="field-wrap">
      <label for="lastName" class="required">Last Name</label>
      <input type="text" name="lastName" id="lastName" [formControl]="formModel.get('lastName')"
              [ngClass]="{onError: lastName.invalid && (lastName.dirty || lastName.touched)}">
      <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)">
        <div class="formErrorMessage" *ngIf="lastName.errors.required">
          Last Name is required.
        </div>
        <div class="formHelpMessage" *ngIf="lastName.errors.minlength">
          Please add {{fieldWidth - lastName.value.length}} more character(s)
        </div>
      </div>
    </div>
  </fieldset>
  
  <fieldset formGroupName="emailGroup" appAsyncEqualValidator>
    <div class="top-row">
      <div class="field-wrap">
        <label for="email" class="required">Email Address</label>
        <input type="email" name="email" id="email" formControlName="email"
                [ngClass]="{onError: email.invalid && (email.dirty || email.touched)}">
        <div class="formErrorMessage" *ngIf="email.invalid && (email.dirty || email.touched)">
          Your Email Address isn't valid
        </div>
      </div>
      <div class="field-wrap">
        <label for="confirm-email" class="required">Confirm Email Address</label>
        <input type="confirm-email" name="confirm-email" id="confirm-email" formControlName="confirmEmail"
                [ngClass]="{onError: confirmEmail.invalid && (confirmEmail.dirty || confirmEmail.touched)}">
        <div class="formErrorMessage" 
            [hidden]="emailGroup.valid || emailGroup.pending || confirmEmail.untouched || confirmEmail.pristine">
          Emails aren't equal
        </div>
        <div class="formHelpMessage" >
            </div>
      </div>
    </div>
  </fieldset>

  <div class="field-wrap">
    <label for="password" class="required">Set A Password</label>
    <input type="password" name="password" id="password" formControlName="password"
            [ngClass]="{onError: password.invalid && (password.dirty || password.touched)}">
    <div *ngIf="password.invalid && (password.dirty || password.touched)">
      <div class="formErrorMessage" *ngIf="password.errors.required">
        Password is required.
      </div>
      <div class="formHelpMessage" *ngIf="firstName.errors.minlength">
        Please add {{fieldWidth - password.value.length}} more character(s)
      </div>
    </div>
  </div>

  <div class="field-wrap">
    <button class="button button-block" [disabled]="formModel.invalid || formModel.pending">Get Started</button>
  </div>
</form>

<!-- <pre>
  {{formModel.value | json}}
  {{formModel.valid}}
</pre> -->
